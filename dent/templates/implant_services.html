{% extends 'dentread_dashbase.html' %}
{% load static %}
{% block content %}
{% if user.is_authenticated %}


<style>
    body{
        background: white;
        padding-left: 80px;
    }
    *{
        box-sizing: border-box;
        line-height: 30px;
        margin: 0;
        padding: 0;
    }
    .container{
        margin: 1rem auto 1rem auto;
        max-width: 1200px;
    }
    .header{
        display: flex;
        align-items: center;
        margin-bottom: 1rem;
    }
    .header img{
        transform: rotate(90deg);
        width: 22px;
    }
    .header h4{
        margin-bottom: 0 !important;
        margin-left: 1rem;
    }
    .content{
        box-shadow: 1px 2px 10px 0px #79797942;
        padding: 1.5rem;
        border-radius: 8px;
    }
    .submit-button, .reset-button{
        width: 161px;
        height: 36px;
        background: #1F3F7F;
        border-radius: 8px;
        color: white;
    }
    .reset-button{
        background-color: white;
        color: #1F3F7F;
        border: 1px solid #1F3F7F;
        margin-left: auto;
    }
    form>.form-group{
        display: flex;
        margin-top: 1rem;
        gap: 1.5rem;
    }
    .search-box{
        border-radius: 0.25rem;
    }
    .search-box input{
        box-shadow: 1px 2px 10px 0px #79797942;
        width: 175px !important;
    }
    .search-enclosing, .filter-section{
        box-shadow: 1px 2px 10px 0px #79797942;
        width: 30px;
        height: 30px;
        border-radius: 8px;
        display: flex;
        justify-content: center;
        border: 1px solid #dfe2e9;
        padding: 6px;
        margin-left: 0.5rem;
    }
    .search-enclosing{
        margin-left: auto;
        padding: 2px !important;
    }
    .actual-content{
        display: flex;
        gap: 2.5rem;
    }
    .button-group{
        display: flex;
        box-shadow: 1px 2px 10px 0px #79797942;
        margin-bottom: 2rem;
        max-width: 400px;
        margin-left: auto;
        margin-right: auto;
    }
    .button-active{
        background-color: #1F3F7F !important;
        color: white;
    }
    .button{
        flex: 1;
        border: none;
        border-radius: 4px;
        background-color: white;
        padding: 3px;
    }
    .helper-text{
        text-align: center;
        margin-bottom: 2rem;
    }
    .patient-search{
        min-width: 61%;
        max-width: 61%;
    }

    /* css for select patient section  */
    .card-enclosing{
        box-shadow: 1px 2px 10px 0px #79797942;;
        margin-bottom: 1rem;
        /* border-left: 5px solid #1F3F7F; */
        padding: 0.5rem;
        border-radius: 8px;
    }
    .row{
        margin-left: 0 !important;
        margin-right: 0 !important;
    }
    .action-enclosing button{
        float: right;
        margin-top: 1rem;
        margin-right: 2rem;
        
    }
    .main-content{
        padding-top: 0 !important;
    }
    
    .icon-enclosing img{
        height: 45px;
    }
    .details-enclosing span:not(.patient-name){
        font-weight: 500;
        /* margin-left: 1px; */
    }
    .details-enclosing{
        margin-left: -3rem !important;
    }
    .action-enclosing{
        margin-left: 3rem;
    }
    .patient-name{
        font-weight: 500;
        text-transform: capitalize;
    }
    .bottom-field{
        width: 100%;
        padding-top: 5px;
        position: relative;
        display: flex;
        justify-content: center;
    }
    .pagination{
        display: flex;
        width: 18%;
        overflow: hidden;
        align-items: center;
        scroll-behavior: smooth;
        background: rgba(31, 63, 127, 0.04);
        box-shadow: inset 1px 4px 8px rgb(129 119 119 / 10%);
        border-radius: 8px;
    }
    .pagination li{
        list-style: none;
        padding: 2px;
        margin: 4px 5px;
        flex-shrink: 0;
        text-align: center;
        border-radius: 5px;
        /* border: 1px solid #999; */
        color: #999;
    }
    
    .pagination li.active{
        background: white;
        color: black;
        border-color: #B0B0B0;
    }
    .pagination li a{
        text-decoration: none;
        padding: 0 8px;
        color: inherit;
        display: block;
        font-family: sans-serif;
        font-size: 13px;
    }
   
    .prev, .last{
        position: absolute;
        border: 1px solid #999;
        padding: 0;
        border: none;
        box-shadow: 1px 4px 14px rgb(129 119 119 / 10%);
        border-radius: 8px;
    }
    a#prev, a#last{
        padding: 0 6px;
    }
    .prev{
        left: 33%;
    }
    .last{
        right: 33%;
    }
    
    .result{
        display: flex;
        margin-bottom: 1rem;
    }
    #cardSearch{
        height: 30px !important;
    }
    .dropdown-menu{
        transform: translate3d(-145px, 44px, 0px);
    }
    .button-select{
        height: 36px;
        background: inherit;
        color: inherit;
        border: none;
    }
    .selected{
        background: #1f3f7f !important;
        color: white !important;
    }
    input, select{
        color: black !important;
    }
    .nothing-to--show{
        font-style: italic;
        color: grey;
        text-align: center;
        margin-top: 5rem;
        font-size: 1rem;
    }
    .dropdown-item:hover{
        color: white;
    }
    input[type="number"]::-webkit-inner-spin-button,
    input[type="number"]::-webkit-outer-spin-button {
    -webkit-appearance: none;
    margin: 0;
</style>

<div class="container">
    <div class="header">
        <img src="/static/svg_icons/arrowleft2.svg" alt="left arrow" style="cursor: pointer;" onclick="history.back()">
        <h4  onclick="history.back()" style="cursor: pointer;">Implant Section </h4>
    </div>

    <div class="actual-content">
        <div class="content planning-guide">
            <div class="button-group" onclick="onButtonGroupClick(event)">
                <button class="button button-active">Implant Planning</button>
                <button class="button">Surgical Guide</button>
            </div>
            <div class="helper-content planning-section">
                <div class="helper-text">
                    Get A Custom Implant Plan For Your Patient. Multiple Case Formats Such As All-On-4, All-on-6, 
                    Full-Mouth Supported And Illustrated With 2D And 3D Images.
                </div>
                <div class="helper-image">
                    <img src="/static/svg_icons/implant-guide.png" alt="implant Planning Image">
                </div>
            </div>
            <div class="helper-content d-none guide-section">
                <div class="helper-text">
                    We Offer Design & Fabrication For Implant Surgical Guides. Our Guide Options Include Tooth, 
                    Tooth & Tissue, Tissue Formats With Options For In-Office Printing or Pre-Fab Guides. 
                </div>
                <div class="helper-image">
                    <img src="/static/svg_icons/implant-planning.png" alt="implant Surigcal Image">
                </div>
            </div>

        </div>
        <div class="content patient-search">
            <div class="button-group" onclick="onButtonGroupClick(event)">
                <button class="button button-active">New Patient</button>
                <button class="button search-patient--button">Search Patient</button>
            </div>
            <form method="post" class="add-patient--section"  action="/add_patient/{{mycat.id}}" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="form-row">
                    {% if message %}
                        <div class="alert alert-{{class}} alert-dismissible fade show" role="alert">
                            <strong></strong> {{message}}
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                    {% endif %}
                    <input class="d-none" name ="optservice" value="3" type="number">

                    <div class="form-group col-sm-12 col-md-6">
                        <label for="locate">Center Name</label>
                        <input type="text" class="form-control" id="locate" value="{{org.orgname}}" name="locate" placeholder="Center Name" required readonly>
                    </div>
                    <div class="col-md-6"></div>
                    <div class="form-group col-sm-12 col-md-6">
                        <label for="name">Patient Name <span class="tx-danger">*</span></label>
                        <input type="text" class="form-control" id="name" name="name" placeholder="Name" required>
                    </div>
                    
                    <div class="form-group col-sm-12 col-md-6">
                        <label for="contact">Mobile <span class="tx-danger">*</span></label>
                        <input type="number" class="form-control" id="contact" name="contact" placeholder="Mobile Number" data-toggle="tooltip" data-placement="left" title="Country Code Mandetory" required >
                    </div>

                    <div class="form-group col-sm-12 col-md-6">
                        <label for="age">Age <span class="tx-danger">*</span></label>
                        <input type="number" class="form-control" id="age" name="age" placeholder="Age" required>
                    </div>

                    <div class="form-group col-sm-12 col-md-6">
                        <label for="gender">Gender <span class="tx-danger">*</span></label>
                        <select name="gender" id="gender" class="form-control" required>
                            <option value="Male" selected>Male</option>
                            <option value="Female">Female</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>

                    <div class="form-group col-sm-12 col-md-6">    
                        <label for="email">Email <span class="tx-danger">*</span></label>
                        <input type="email" class="form-control" id="email" name="email" placeholder="Email ID" required >
                    </div>
                    
                    <div class="form-group col-sm-12 col-md-6">
                        <label for="address">Address <span class="tx-danger">*</span></label>
                        <input type="text" class="form-control" id="address" name="address" placeholder="Address" required>     
                    </div>

                    <div class="form-group col-sm-12 col-md-6">
                        <label for="pincode">Pincode <span class="tx-danger">*</span></label>
                        <input type="number" class="form-control" id="pincode" name="pincode" placeholder="Pincode" required>
                    </div>

                    <div class="form-group col-sm-12 col-md-6">
                        <label for="prescription">Prescription</label>
                        <div class="custom-file">
                            <input type="file" class="custom-file-input" id="prescription" name="prescription" >
                            <label class="custom-file-label" for="prescription">Choose file</label>
                        </div>
                    </div>
                    
                </div>
                <div class="form-group">
                    <button type="reset" class="btn reset-button">Cancel</button>
                    <button type="submit" class="btn submit-button">Save</button>
                </div>
            </form>
            <div class="select-patient--section d-none">
                <div class="result">
                    <div class="result-box">Result: <span></span></div>
                    <!-- Results: <span></span> -->
                    <div class="search-enclosing" onclick="onSearchAnimate(this)">
                        <img src="/static/svg_icons/ei_search_icon.svg" alt="">
                    </div>
                    <div class="search-box d-none ml-1">
                        <input type="text" placeholder="Search Name here..." class="form-control" id="cardSearch" onkeydown="onNameSearch(this.value)">
                    </div>
                    <div class="filter-section">
                        <!-- <button aria-expanded="false" aria-haspopup="true" class="kebab-button btn ripple btn-sm btn-outline-primary ml-auto" style="margin-right: 12px;" data-toggle="dropdown"
                            id="dropleftMenuButton" type="button"><i class="si si-options-vertical"></i>
                        </button> -->
                        <img aria-expanded="false" aria-haspopup="true" id="dropleftMenuButton" data-toggle="dropdown" src="/static/svg_icons/filter.svg" alt="">
                        
                        <div aria-labelledby="dropleftMenuButton" class="dropdown-menu tx-13">
                            <form action="/implant_services/{{mycat.id}}" onclick="onQueryDateClick(event);" method="post">
                                {% csrf_token %}
                                <input type="text" name="query_date" class="d-none">
                                <a class="dropdown-item" style="cursor: pointer;" href="#">
                                Today
                                </a>
                                <a class="dropdown-item" style="cursor: pointer;" href="#">
                                    Yesterday
                                </a>
                                <a class="dropdown-item" style="cursor: pointer;" href="#">
                                    This Week
                                </a>
                            </form>   
                            
                        </div>
                    </div>
                </div>
                <div class="main-content">

                    {% for i in patient %}
                        <div class="card-enclosing row">
                            <div class="col-sm-2 icon-enclosing d-flex align-items-center">
                                {% if i.gender == 'Female' %}
                                    <img src="/static/svg_icons/female-pink.svg" alt="female icon">
                                {% endif %}
                                {% if i.gender != 'Female' %}
                                    <img src="/static/svg_icons/Male.svg" alt="male icon">
                                {% endif %}
                            </div>
                            <div class="col-sm-9 details-enclosing row">
                                {% if i.name and i.name != 'None' and i.name != '' %}
                                    <div class="col-sm-4"><span class="patient-name">{{i.name}}</span> </div>
                                {% endif %}
                                {% if i.pid and i.pid != 'None' and i.pid != '' %}
                                <div class="col-sm-4">ID: <span>{{i.pid}}</span></div>
                                {% endif %}
                                {% if i.rdate and i.rdate != 'None' and i.rdate != '' %}
                                    <div class="col-sm-4"> Date: <span>{{i.rdate | date:"M j, Y"}}</span> </div>
                                {% endif %}
                                {% if i.age and i.age != 'None' and i.age != '' %}
                                    <div class="col-sm-4">Age: <span>{{i.age}}</span></div>
                                {% endif %}
                                {% if i.gender and i.gender != 'None' and i.gender != '' %}
                                    <div class="col-sm-4">Gender: <span>{{i.gender}}</span></div>
                                {% endif %}

                            </div>
                            <div class="col-sm-1 action-enclosing">
                                
                                <button aria-expanded="false" aria-haspopup="true" class="kebab-button btn ripple btn-sm btn-outline-primary ml-auto" style="margin-right: 12px;" data-toggle="dropdown"
                                    id="dropleftMenuButton" type="button"><i class="si si-options-vertical"></i>
                                </button>
                                
                                <div aria-labelledby="dropleftMenuButton" class="dropdown-menu tx-13">
                                    <a class="dropdown-item" style="cursor: pointer;" href="#" onclick="onOrderForm('{{ i.id }}')">
                                        <i class="fa fa-user-circle" aria-hidden="true"></i> Select Patient
                                    </a>
                                    <a class="dropdown-item" style="cursor: pointer;" href="/patientdetails/{{ i.id }}">
                                        <i class="fa fa-info-circle" aria-hidden="true"></i>View Patient
                                    </a>
                                    
                                </div>
                            
                            </div>
                        </div>
                    {% endfor %}

                </div>
                <div class="bottom-field">
                    <ul class="pagination" onclick="onPaginationClick(event)">
                        <li class="prev">
                            <a href="#1" id="prev">
                                <img src="/static/svg_icons/pagination-left.svg" alt="">
                            </a>
                        </li>
                        <li class="last">
                            <a href="#1" id="last">
                                <img src="/static/svg_icons/pagination-left.svg" alt="" style="transform: rotate(180deg);">
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="nothing-to--show d-none">
                    No Patients Available
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    document.querySelector('.custom-file-input').addEventListener('change',function(e){
        var fileName = document.getElementById("prescription").files[0].name;
        var nextSibling = e.target.nextElementSibling
        nextSibling.innerText = fileName
    });
</script>
<script>
    let mainUrl = '/refer_services';
    let topcat = 3
    function onOrderForm(patientId){
        window.location.href = mainUrl+`/${patientId}`+`/${topcat}`;
    }
    function onQueryDateClick(event){
        if(event.target.tagName=='A'){
            document.getElementsByName('query_date')[0].value = event.target.innerText.split(' ').join('').toLowerCase()
            event.target.parentElement.submit()
        }
    }
</script>

<script>

    function onButtonGroupClick(event){
        let target = event.target

        if(target.tagName.toLowerCase() == 'button'){
            
            for(let x of target.parentElement.querySelectorAll('button')){
                if(target.innerText == x.innerText){
                    x.classList.add('button-active');
                }
                else{
                    x.classList.remove('button-active');
                }
            }
            
            if(target.parentElement.parentElement.classList.contains('planning-guide')){
                planningGuideHide(target.innerText);
                document.querySelector('.selected').classList.remove('selected');
            } 
            else{
                patientSectionHide(target.innerText);
            }
        
        }

        else if(target.tagName.toLowerCase() == 'select'){
            target.classList.add('selected');
            target.parentElement.classList.add('button-active');
            target.parentElement.previousElementSibling.classList.remove('button-active');
            planningGuideHide('guide');
        }
    }

    function planningGuideHide(text){
        
        if(text == 'Implant Planning'){
            document.querySelector('.planning-section').classList.remove('d-none');
            document.querySelector('.guide-section').classList.add('d-none');
            topcat = 3
            document.getElementsByName('optservice')[0].value = '3'
        }
        else{
            document.querySelector('.planning-section').classList.add('d-none');
            document.querySelector('.guide-section').classList.remove('d-none');
            topcat = 4
            document.getElementsByName('optservice')[0].value = '4'
        }

    }

    function patientSectionHide(text){
        if(text == 'New Patient'){
            document.querySelector('.add-patient--section').classList.remove('d-none');
            document.querySelector('.select-patient--section').classList.add('d-none');
        }
        else{
            document.querySelector('.add-patient--section').classList.add('d-none');
            document.querySelector('.select-patient--section').classList.remove('d-none');
        }
    }


</script>

<script>
    function hideBottomField(res){
        if(!res){
            document.querySelector('.bottom-field').classList.add('d-none');
            
            document.querySelector('.nothing-to--show').classList.remove('d-none');
        }
        else{
            document.querySelector('.bottom-field').classList.remove('d-none');
            document.querySelector('.nothing-to--show').classList.add('d-none');
        }
    }
    //patient filling here
    
    let totalPatients = [];

    for(let x of document.querySelectorAll('.card-enclosing')){
        totalPatients.push(x);
    }
    totalPatients.reverse();
    let allPatients = [...totalPatients]

    document.querySelector('.result span').innerText = allPatients.length;
    
    //cards allowed per page
    let cardsAllowed = 5;

    function nosPaginationFunction(){
        return Math.ceil(allPatients.length/cardsAllowed);
    }
    let nosPagination = 0;
    // paginationNumbers here 
    function paginationNumber(){
        nosPagination = nosPaginationFunction();
        for(let i= 1; i<=nosPagination; i++){

            // li creation 
            let li= document.createElement('li');
            li.classList.add('list');
            li.setAttribute('id', "item"+`${i}`);

            // anchor creation 
            let a= document.createElement('a');
            a.href= '#1';
            a.innerText = i;

            // appending anchor to the list item
            li.appendChild(a);
            

            // appending li to the ul 

            document.querySelector('.pagination').insertBefore(li, document.querySelector('.last'));
        }
    }
    paginationNumber();
    
    //current page: by default 1
    currentPage = 1;
    prevActiveLi = document.querySelector('.list');
    prevActiveLi.classList.add('active');

    // display the page 
    function displayPage(){
        document.querySelector('.main-content').innerHTML = '';
        for(let i= 0; i<cardsAllowed; i++){
            let exNum = allPatients[cardsAllowed*(currentPage-1)+i];
            if(exNum){
                document.querySelector('.main-content').appendChild(allPatients[cardsAllowed*(currentPage-1)+i]);
            }
        }
        hideBottomField(allPatients.length);
        
    }
    displayPage();

    // function to activate the list 
    function liActive(){
        for(let i of document.querySelectorAll('.list')){
            console.log('inside liActive(): ', i.innerText);
            if(i.innerText == currentPage){
                i.classList.add('active');
                prevActiveLi.classList.remove('active');
                prevActiveLi = i;
                break;
            }
            
        } 
    }

    let currentPaginatioTarget = currentPage;

    function onPaginationClick(event){
        target = event.target;
        if(target.tagName == 'IMG'){
            target = target.parentElement;
        }
        // console.log(target);
        if(target.tagName == 'A' && target.getAttribute('id')!= 'prev' && target.getAttribute('id')!= 'last'){
            currentPage = target.innerText;
            currentPaginatioTarget = currentPage;
            liActive();
            displayPage();
        }
        else if(target.tagName == 'A' && target.getAttribute('id') == 'prev' ){

            currentPaginatioTarget -= 3;
            if(currentPaginatioTarget < 1){
                currentPaginatioTarget = 1;
            }

            target.href = '#item'+`${currentPaginatioTarget}`;
            // console.log("new target is", target.href);
            
        }
        else if(target.tagName == 'A' && target.getAttribute('id') == 'last' ){
                
            currentPaginatioTarget = parseInt(currentPaginatioTarget) + 3;

            if(currentPaginatioTarget>nosPagination){
                currentPaginatioTarget = nosPagination;
            }
            
            target.href = '#item'+`${currentPaginatioTarget}`;
            // console.log("new target is", target.href);
            
        }
    }

    function onSearchAnimate(target){
        target.parentElement.querySelector('.search-box').classList.toggle('d-none');
    }

    function onNameSearch(name){
        allPatients = [];
        totalPatients.forEach(element => {
            if(element.querySelector('.patient-name').innerText.toLowerCase().includes(name.toLowerCase())){
                allPatients.push(element);
            }
        });
        document.querySelector('.result span').innerText = allPatients.length;
        // console.log(allPatients.length);
        // console.log(allPatients);
        for(let x of document.querySelectorAll('.list')){
            x.remove();
        }
        paginationNumber();
        currentPage = 1;
        liActive();
        displayPage();
    }

</script>

<script>
    
    console.log(' btn checked with: ', "{{btnchecked}}")
    if('{{btnchecked}}'!='none' && '{{btnchecked}}'!=''){
        console.log('inside btn checked with: ', "{{btnchecked}}")
        hideBottomField(allPatients.length);
        document.querySelector('.search-patient--button').click();
    }
</script>

<!-- <style>
	fieldset.scheduler-border {
		border: 1px groove #ddd !important;
		padding: 0 1.4em 1.4em 1.4em !important;
		margin: 0 0 1.5em 0 !important;
		-webkit-box-shadow:  0px 0px 0px 0px #000;
				box-shadow:  0px 0px 0px 0px #000;
	}
	
		legend.scheduler-border {
			font-size: 1.2em !important;
			font-weight: bold !important;
			text-align: left !important;
			width:auto;
			padding:0 10px;
			border-bottom:none;
		}

    @media  screen and (max-width: 750px) {
        #fixed-width-height{
            height: 500px !important;
            width: 500px !important;
        }
    }  
    th.sorting, td{
        display:  table-cell !important;
    }
    small, .small{
        font-size: 14px !important;
        
    }

    #example2_filter{
        display: flex !important;
        justify-content: end !important;
        text-align: end;
    }

    #example2_wrapper>div:nth-child(2) {
        overflow-x:auto !important;
    }

    .actions-n-center{
        display: table-cell !important;
    }
    #image-analysis-planning--style{
        background-color: #2f6ebb;
        color: white;
        padding-left: 1rem;
        padding-right: 1rem;
        padding-top: 0.7rem;
        padding-bottom: 0.7rem;
        border-radius: 0.3rem;
    }

    fieldset{
        border-radius: 0.5rem;
    }  

    .carousel-slider #thumbcarousel .carousel-item .thumb {
        max-width: 81px !important;
    }
    
</style>



<div class="main-content side-content pt-0">
    <div class="container-fluid" style="overflow-x: hidden;">
        <div class="inner-body">

            <div class="row row-sm" style="margin-top: 2rem !important;">
                <div class="col-lg-12 col-md-12">
                    <div class="card custom-card productdesc">
                        <div class="card-body h-100">
                            <div class="row">
                                <div class="col-xl-4 col-lg-12 col-md-12">
                                    <div class="row" style="justify-content: center;">
                                        
                                        <div class="col-md-11 offset-md-0 col-sm-10 col-9">
                                            <fieldset class="scheduler-border">
                                                <legend class="scheduler-border"><h4 id="image-analysis-planning--style">Implant Planning
                                                    Planning</h4></legend>
                                                <div class="control-group">
                                                    <p style="line-height: 1.7rem;">Get A Custom Implant Plan For Your Patient. Multiple Case Formats Such As All-On-4, All-on-6, Full-Mouth Supported And Illustrated With 2D And 3D Images.

                                                    </p>
                                            </fieldset>
                                        </div>
                                        <div class="col-md-11 offset-md-0 col-sm-10 col-9">
                                            <div class="carousel">
                                                <div id="carousel" class="carousel slide" data-ride="carousel">
                                                    <div class="carousel-inner">
                                                        <div class="carousel-item active"><img
                                                                src="{% static '/services/planning/planning1.jpg' %}"
                                                                alt="img" id= 'fixed-width-height' style="width: 100%;">
                                                        </div>

                                                        <div class="carousel-item"><img
                                                                src="{% static '/services/planning/planning2.jpg' %}"
                                                                alt="img" id= 'fixed-width-height' style="width: 100%;">
                                                            
                                                        </div>
                                                        <div class="carousel-item"><img
                                                                src="{% static '/services/planning/planning3.jpg' %}"
                                                                alt="img" id= 'fixed-width-height' style="width: 100%;" >
                                                            
                                                        </div>
                                                        <div class="carousel-item"><img
                                                            src="{% static '/services/planning/planning4.jpg' %}"
                                                            alt="img" id= 'fixed-width-height' style="width: 100%;">
                                                        
                                                    </div>
                                                    </div>
                                                    <a class="carousel-control-prev" href="#carousel" role="button"
                                                       data-slide="prev">
                                                        <span class="carousel-control-prev-icon"
                                                              aria-hidden="true"></span>
                                                        <span class="sr-only">Previous</span>
                                                    </a>
                                                    <a class="carousel-control-next" href="#carousel" role="button"
                                                       data-slide="next">
                                                        <span class="carousel-control-next-icon"
                                                              aria-hidden="true"></span>
                                                        <span class="sr-only">Next</span>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row-2">
                                            <div class="clearfix carousel-slider">
                                                <div id="thumbcarousel" class="carousel slide" data-interval="false">
                                                    <div class="carousel-inner">
                                                        <div class="carousel-item active">
                                                            <div data-target="#carousel" data-slide-to="0"
                                                                 class="thumb my-2"><img
                                                                    src="{% static '/services/planning/planning1.jpg' %}"
                                                                    alt="img"></div>
                                                            <div data-target="#carousel" data-slide-to="1"
                                                                 class="thumb my-2"><img
                                                                    src="{% static '/services/planning/planning2.jpg' %}"
                                                                    alt="img"></div>
                                                            <div data-target="#carousel" data-slide-to="2"
                                                                 class="thumb my-2"><img
                                                                    src="{% static '/services/planning/planning3.jpg' %}"
                                                                    alt="img"></div>
                                                            <div data-target="#carousel" data-slide-to="3"
                                                                 class="thumb my-2"><img
                                                                    src="{% static '/services/planning/planning4.jpg' %}"
                                                                    alt="img"></div>

                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xl-8 col-lg-12 col-md-12">
                                    <div class="col-md-11 col-sm-9 col-8 mt-3" style="display: flex;">
                                        <div class="col-md-11 col-sm-9 col-8 mt-3" style="display: flex;">
                                            <div class="d-flex ml-2" style="margin-right: auto;">
                                                <form action="/implant_services/{{mycat.id}}" method="post" style="margin-top: 0.5rem !important;">
                                                    {% csrf_token %}
                                                    <div class="input-group">
                                                        <input type="search" class="form-control form-control-sm" name="search" id="search" placeholder="Type Patient name, Centre or Registration date " 
                                                        style="width: 250px !important;">
                                                        <div class="input-group-append">
                                                            <button type="submit" class="btn btn-sm btn-primary" style="font-size: inherit !important;">
                                                                <i class="fa fa-search"></i>
                                                            Search</button>
                                                        </div>
                                                    </div>
                                                </form>
                                            </div>
                                            <div class="d-flex" style="margin-right: -7rem;">
                                                <div class="form-group">
                                                    <a href="/add_patient/{{mycat.id}}"
                                                       class="btn btn-block btn-primary my-2 btn-icon-text">
                                                        <i class="fe fe-plus mr-4"></i> Register New Patient
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="colors d-flex mr-3 mt-2">
                                        <div class="container-fluid">
                                            <div class="inner-body">
                                                <div class="page-header">
                                                    <div>
                                                        <h4 class="text-primary">Refer Existing Patient</h4>
                                                    </div>
                                                    <div class="d-flex ml">
                                                        <div class="justify-content-center">
                                                            <div class="btn btn-list">
                                                                <form method="post"
                                                                      action="/implant_services/{{mycat.id}}">
                                                                    {% csrf_token %}

                                                                    <div aria-label="Basic example"
                                                                        class="btn btn-group" role="group">
                                                                        <input name="query_date" id="query_date" hidden>
                                                                        <button class="btn ripple pd-x-25"
                                                                                type="implant" value="today" id='todayFilter' style="border-top-left-radius: 3px; border-bottom-left-radius: 3px; border: 1px solid;"
                                                                                onclick="todayFunction()" {{check1}}>Today
                                                                        </button>
                                                                        <button class="btn ripple pd-x-25"
                                                                                type="implant" value="yesterday" id='yesterdayFilter' style='border: 1px solid; border-left:none'
                                                                                onclick="yesterdayFunction()" {{check2}}>
                                                                            Yesterday
                                                                        </button>
                                                                        <button class="btn ripple pd-x-25" style='border: 1px solid; border-left:none' 
                                                                                type="implant" value="thisweek" id='thisweekFilter'
                                                                                onclick="thisweekFunction()" {{check3}}>This
                                                                            Week
                                                                        </button>
                                                                    </div>
                                                                </form>
                                                                <script>
																	console.log('this is before fnctions', `{{btnchecked}}`)
                                                                    let todayFunction= function () {
                                                                        document.getElementById("query_date").value='today';
                                                                        console.log('inside today')
                                                                    }
                                                                    let yesterdayFunction= function () {
                                                                        document.getElementById("query_date").value = 'yesterday';
                                                                        console.log('inside yesterday')
                                                                    }
                                                                    let thisweekFunction= function () {
                                                                        document.getElementById("query_date").value = 'thisweek';
                                                                        console.log('inside thisweek')
                                                                    }
                                                                    if(`{{btnchecked}}`=='todayFunction'){
                                                                        console.log('inside today btnchecked function ')
                                                                        document.getElementById('todayFilter').classList.add('btn-primary')
                                                                        document.getElementById('todayFilter').style.border='none'
                                                                    }
                                                                    if(`{{btnchecked}}`=='yesterdayFunction'){
                                                                        console.log('inside yesterday btnchecked function ')
                                                                        document.getElementById('yesterdayFilter').classList.add('btn-primary')
                                                                        document.getElementById('yesterdayFilter').style.border='none'
                                                                    }
                                                                    if(`{{btnchecked}}`=='thisweekFunction'){
                                                                        console.log('inside thisweek btnchecked function ')
                                                                        document.getElementById('thisweekFilter').classList.add('btn-primary')
                                                                        document.getElementById('thisweekFilter').style.border='none'
                                                                    }
                                                                </script>	
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-12">
                                                        <div class="card">
                                                            <div class="card-body">

                                                                <table id="example2"
                                                                       class="table table-bordered border-t0 key-buttons  w-100">
                                                                    <thead>
                                                                        <tr style="color:white;">
                                                                            <th style="background-color:#2f6ebb;color:white;">
                                                                                Date
                                                                            </th><th style="background-color:#2f6ebb;color:white;">
                                                                                ID
                                                                            </th><th style="background-color:#2f6ebb;color:white;">
                                                                                Name
                                                                            </th>
                                                                            <th style="background-color:#2f6ebb;color:white;">
                                                                                Age
                                                                            </th>
                                                                            
                                                                            <th style="background-color:#2f6ebb;color:white;">
                                                                                Gender
                                                                            </th>
                                                                            <th style="background-color:#2f6ebb;color:white;" class="actions-n-center">
                                                                                Center
                                                                            </th>
                                                                           
                                                                            <th style="background-color:#2f6ebb;color:white;" class="actions-n-center">
                                                                                Actions
                                                                            </th>
                                                                        </tr>
                                                                        </thead>
    
                                                                        <tbody>
                                                                        {% for i in patient %}
                                                                        <tr>
                                                                            <td>{{ i.rdate|date:'d-m-Y' }}</td>
                                                                            <td>{{ i.pid }}</td>
                                                                            <td><small class="{{i.st}}">{{ i.name }}</td>
                                                                            <td>{{ i.age }}</td>
                                                                            <td>{{i.gender}}</td>
                                                                            <td>{{ i.locate }}</td>
                                                                            <td>
                                                                                <button aria-expanded="false" aria-haspopup="true"
                                                                                    class="btn ripple btn-sm btn-outline-primary ml-auto" style="margin-right: 12px;" data-toggle="dropdown"
                                                                                    id="dropleftMenuButton" type="button"><i class="si si-options-vertical"></i>
                                                                                </button>
                                                                                
                                                                                <div aria-labelledby="dropleftMenuButton" class="dropdown-menu tx-13">
                                                                                    <a class="dropdown-item" href="/refer_services/{{i.id}}/{{mycat.id}}"> Select Patient</a>
                                                                                    <a class="dropdown-item" href="/patientdetails/{{ i.id }}"> View Patient</a>
                                                                                </div>
                                                                            </td>
                                                                    </tr>
                                                                    {% endfor %}
                                                                    </tbody>
                                                                </table>


                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>


                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>
</div>
<script src="{% static '/plugins/jquery/jquery.min.js' %}"></script>
<script>
window.alert = (function() {
    var nativeAlert = window.alert;
    return function(message) {
        window.alert = nativeAlert;
        message.indexOf("DataTables warning") === 0 ?
            console.warn(message) :
            nativeAlert(message);
    }
})();

</script>
<script>
 $(function () {
    $("#example2").DataTable({

       "order": [[ 1, "desc" ]],
       "columns": [
            null, { orderable: false },  null, { orderable: false }, { orderable: false }, { orderable: false }, { orderable: false }
        ],
       "paging": true,
       "lengthChange": false,
       "searching": true,
       "info": true,
       "autoWidth": false,
       "responsive": true,
       "pageLength": 5,

    });
    let label = document.querySelector('#example2_filter>label');
    label.firstChild.textContent='Filter';

  });

</script> -->

{% endif %}
{%endblock%}